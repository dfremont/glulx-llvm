image:
  - Visual Studio 2019
  - Ubuntu
  - macOS
install:
  - git submodule update --init --recursive --depth 1


for:
-
  matrix:
    only:
      - image: Visual Studio 2019
  init:
    - call "C:\Program Files (x86)\Microsoft Visual Studio\2019\Community\VC\Auxiliary\Build\vcvars64.bat"
  build_script:
  - cmd: |
      cd llvm-project/llvm
      mkdir build
      cd build
      cmake -G "Ninja" -DCMAKE_BUILD_TYPE=Release -DLLVM_ENABLE_PROJECTS="clang" -DLLVM_TARGETS_TO_BUILD="Glulx" -DCMAKE_C_COMPILER=clang-cl.exe -DCMAKE_CXX_COMPILER=clang-cl.exe ..
      ninja

build_script:
  - sh: |
      cd llvm-project/llvm
      mkdir build
      cd build
      cmake -G "Ninja" -DCMAKE_BUILD_TYPE=Release -DLLVM_ENABLE_PROJECTS="clang" -DLLVM_TARGETS_TO_BUILD="Glulx" ..
      ninja
